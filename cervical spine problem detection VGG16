{"cells":[{"cell_type":"markdown","metadata":{"id":"vMOS3K914BTW"},"source":["#Imports"]},{"cell_type":"code","source":["! nvidia-smi"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"NDYaZW82-qxa","executionInfo":{"status":"ok","timestamp":1680892224470,"user_tz":-360,"elapsed":5,"user":{"displayName":"MUHTASIM HOSSAIN 201-15-3444","userId":"12703241037601351444"}},"outputId":"cd62d977-76b5-4021-80f5-61d0e1d2a4c6"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Fri Apr  7 18:30:24 2023       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 525.85.12    Driver Version: 525.85.12    CUDA Version: 12.0     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   62C    P0    28W /  70W |   8999MiB / 15360MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","+-----------------------------------------------------------------------------+\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HOz7D-Mr33MP"},"outputs":[],"source":["import tensorflow as tf\n","import numpy as np\n","import matplotlib.pyplot as plt\n","\n","import tensorflow_hub as hub\n","import tensorflow_datasets as tfds\n","\n","from tensorflow.keras import layers\n","from tensorflow.keras.preprocessing.image import ImageDataGenerator"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9-kvtl3l4KCd"},"outputs":[],"source":["import logging\n","logger = tf.get_logger()\n","logger.setLevel(logging.ERROR)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HDAhqbm0U0FR"},"outputs":[],"source":["import keras\n","from keras.applications.mobilenet import MobileNet\n","\n","from sklearn.metrics import confusion_matrix\n","from keras.layers.core import Dense, Activation\n","from keras.metrics import categorical_crossentropy\n","from keras.metrics import binary_crossentropy\n","from sklearn.model_selection import train_test_split\n","from keras.preprocessing.image import ImageDataGenerator\n","from keras.applications.mobilenet import preprocess_input\n","from tensorflow.keras.preprocessing import image_dataset_from_directory\n","import tensorflow as tf\n","from keras.preprocessing import image"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_h6Sl8ONvhsb"},"outputs":[],"source":["train_datagen = image.ImageDataGenerator(\n","    rescale=1./255,\n","    shear_range = 0.3,\n","    zoom_range = 0.3,\n","    horizontal_flip = True,\n",")\n","validation_datagen = image.ImageDataGenerator(\n","    rescale = 1./255\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4091,"status":"ok","timestamp":1680892246253,"user":{"displayName":"MUHTASIM HOSSAIN 201-15-3444","userId":"12703241037601351444"},"user_tz":-360},"id":"Q7hdTDivJdCk","outputId":"45192302-89c9-40de-cf7c-40c5ad95c78e"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":958,"status":"ok","timestamp":1680892250995,"user":{"displayName":"MUHTASIM HOSSAIN 201-15-3444","userId":"12703241037601351444"},"user_tz":-360},"id":"E9Drky6k4W-b","outputId":"641b8340-bb74-4e66-e6a2-adda3741f008"},"outputs":[{"output_type":"stream","name":"stdout","text":["Found 17511 images belonging to 5 classes.\n","Found 2500 images belonging to 5 classes.\n","Found 4996 images belonging to 5 classes.\n"]}],"source":["train = train_datagen.flow_from_directory(\n","    '/content/drive/MyDrive/cervical cancer/cervical part/train',\n","    target_size = (224, 224),\n","    batch_size = 32,\n","    class_mode = 'categorical'\n",")\n","\n","validation = validation_datagen.flow_from_directory(\n","    '/content/drive/MyDrive/cervical cancer/cervical part/validation',\n","    target_size = (224, 224),\n","    batch_size = 32,\n","    class_mode = 'categorical'\n",")\n","\n","test = validation_datagen.flow_from_directory(\n","    '/content/drive/MyDrive/cervical cancer/cervical part/test',\n","    target_size = (224, 224),\n","    batch_size = 32,\n","    shuffle = False,\n","    class_mode = 'categorical'\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2OPt4lGVXNwi"},"outputs":[],"source":["VGG16 = tf.keras.applications.VGG16(\n","    include_top=False, \n","    weights = 'imagenet', \n","    input_shape=(224,224,3),\n","    )"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WVsglu3geWg1"},"outputs":[],"source":["VGG16.trainable = False"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MQ7Q0BZxRfyf"},"outputs":[],"source":["model = tf.keras.models.Sequential([\n","  VGG16,\n","  tf.keras.layers.Flatten(),\n","  tf.keras.layers.Dropout(0.8),\n","  tf.keras.layers.Dense(units=1024, activation='relu'),\n","  tf.keras.layers.Dense(units=512, activation='relu'),\n","  tf.keras.layers.Dense(units=5, activation='softmax'), \n","])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1680892262223,"user":{"displayName":"MUHTASIM HOSSAIN 201-15-3444","userId":"12703241037601351444"},"user_tz":-360},"id":"hfrj3qIfdt0u","outputId":"784fbec7-9cff-4c12-d412-0ce921d0a94a"},"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"sequential_1\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," vgg16 (Functional)          (None, 7, 7, 512)         14714688  \n","                                                                 \n"," flatten_1 (Flatten)         (None, 25088)             0         \n","                                                                 \n"," dropout_1 (Dropout)         (None, 25088)             0         \n","                                                                 \n"," dense_3 (Dense)             (None, 1024)              25691136  \n","                                                                 \n"," dense_4 (Dense)             (None, 512)               524800    \n","                                                                 \n"," dense_5 (Dense)             (None, 5)                 2565      \n","                                                                 \n","=================================================================\n","Total params: 40,933,189\n","Trainable params: 40,933,189\n","Non-trainable params: 0\n","_________________________________________________________________\n"]}],"source":["model.compile(\n","    optimizer = 'adam',\n","    loss = 'categorical_crossentropy',\n","    metrics = ['accuracy']\n",")\n","model.summary()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13513048,"status":"ok","timestamp":1680905780195,"user":{"displayName":"MUHTASIM HOSSAIN 201-15-3444","userId":"12703241037601351444"},"user_tz":-360},"id":"iu6SIRqVemSD","outputId":"ede6a011-53ea-494a-c534-216add55ac9e"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/20\n","548/548 [==============================] - 6328s 12s/step - loss: 1.6702 - accuracy: 0.1992 - val_loss: 1.6095 - val_accuracy: 0.2000\n","Epoch 2/20\n","548/548 [==============================] - 375s 684ms/step - loss: 1.6095 - accuracy: 0.2012 - val_loss: 1.6095 - val_accuracy: 0.2000\n","Epoch 3/20\n","548/548 [==============================] - 373s 681ms/step - loss: 1.6096 - accuracy: 0.1975 - val_loss: 1.6095 - val_accuracy: 0.2000\n","Epoch 4/20\n","548/548 [==============================] - 374s 683ms/step - loss: 1.6096 - accuracy: 0.1966 - val_loss: 1.6095 - val_accuracy: 0.2000\n","Epoch 5/20\n","548/548 [==============================] - 374s 682ms/step - loss: 1.6096 - accuracy: 0.2003 - val_loss: 1.6095 - val_accuracy: 0.2000\n","Epoch 6/20\n","548/548 [==============================] - 373s 680ms/step - loss: 1.6096 - accuracy: 0.1964 - val_loss: 1.6094 - val_accuracy: 0.2000\n","Epoch 7/20\n","548/548 [==============================] - 373s 681ms/step - loss: 1.6096 - accuracy: 0.1967 - val_loss: 1.6095 - val_accuracy: 0.2000\n","Epoch 8/20\n","548/548 [==============================] - 374s 683ms/step - loss: 1.6096 - accuracy: 0.1964 - val_loss: 1.6094 - val_accuracy: 0.2000\n","Epoch 9/20\n","548/548 [==============================] - 372s 677ms/step - loss: 1.6096 - accuracy: 0.1991 - val_loss: 1.6095 - val_accuracy: 0.2000\n","Epoch 10/20\n","548/548 [==============================] - 369s 672ms/step - loss: 1.6096 - accuracy: 0.1929 - val_loss: 1.6094 - val_accuracy: 0.2000\n","Epoch 11/20\n","548/548 [==============================] - 370s 674ms/step - loss: 1.6096 - accuracy: 0.1939 - val_loss: 1.6094 - val_accuracy: 0.2000\n","Epoch 12/20\n","548/548 [==============================] - 373s 681ms/step - loss: 1.6096 - accuracy: 0.1967 - val_loss: 1.6095 - val_accuracy: 0.2000\n","Epoch 13/20\n","548/548 [==============================] - 373s 680ms/step - loss: 1.6096 - accuracy: 0.1914 - val_loss: 1.6094 - val_accuracy: 0.2000\n","Epoch 14/20\n","548/548 [==============================] - 374s 682ms/step - loss: 1.6096 - accuracy: 0.1975 - val_loss: 1.6095 - val_accuracy: 0.2000\n","Epoch 15/20\n","548/548 [==============================] - 379s 691ms/step - loss: 1.6096 - accuracy: 0.1975 - val_loss: 1.6095 - val_accuracy: 0.2000\n","Epoch 16/20\n","548/548 [==============================] - 382s 696ms/step - loss: 1.6096 - accuracy: 0.1973 - val_loss: 1.6095 - val_accuracy: 0.2000\n","Epoch 17/20\n","548/548 [==============================] - 379s 691ms/step - loss: 1.6096 - accuracy: 0.1931 - val_loss: 1.6094 - val_accuracy: 0.2000\n","Epoch 18/20\n","548/548 [==============================] - 380s 692ms/step - loss: 1.6096 - accuracy: 0.1982 - val_loss: 1.6095 - val_accuracy: 0.2000\n","Epoch 19/20\n","548/548 [==============================] - 382s 697ms/step - loss: 1.6096 - accuracy: 0.1967 - val_loss: 1.6095 - val_accuracy: 0.2000\n","Epoch 20/20\n","548/548 [==============================] - 380s 693ms/step - loss: 1.6096 - accuracy: 0.1986 - val_loss: 1.6095 - val_accuracy: 0.2000\n"]}],"source":["history = model.fit(\n","    x = train, \n","    validation_data = validation,\n","    epochs = 20\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-AKZLem1xiVW","outputId":"a66ad690-10b9-4afc-ebd7-9db20c2fc233","executionInfo":{"status":"ok","timestamp":1680907739215,"user_tz":-360,"elapsed":1955881,"user":{"displayName":"MUHTASIM HOSSAIN 201-15-3444","userId":"12703241037601351444"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["157/157 [==============================] - 1903s 12s/step - loss: 1.6095 - accuracy: 0.2002\n","Accuracy: 0.20016013085842133\n","Loss: 1.6094684600830078\n"]}],"source":["# Evaluate the loss and accuracy\n","loss, accuracy = model.evaluate(test)\n","\n","# Print the accuracy\n","print(\"Accuracy: \" + str(accuracy))\n","# Print the loss\n","print(\"Loss: \" + str(loss))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":525,"status":"ok","timestamp":1680908174658,"user":{"displayName":"MUHTASIM HOSSAIN 201-15-3444","userId":"12703241037601351444"},"user_tz":-360},"id":"AbnTVtBRx8K7","outputId":"af6278fe-00ff-49b3-c3c0-9e936b6c357c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'cervix_dyk': 0,\n"," 'cervix_koc': 1,\n"," 'cervix_mep': 2,\n"," 'cervix_pab': 3,\n"," 'cervix_sfi': 4}"]},"metadata":{},"execution_count":24}],"source":["test.class_indices"]}],"metadata":{"accelerator":"GPU","colab":{"provenance":[{"file_id":"1W23kNYEY_J2zA-fE6-UHrmmrfsJQCC8z","timestamp":1670515665645}]},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}